#!/bin/bash
# DAIC command to toggle between Discussion and Implementation modes

# Get the project root (where .claude directory is)
PROJECT_ROOT="$(pwd)"
while [[ ! -d "$PROJECT_ROOT/.claude" && "$PROJECT_ROOT" != "/" ]]; do
    PROJECT_ROOT="$(dirname "$PROJECT_ROOT")"
done

if [[ "$PROJECT_ROOT" == "/" ]]; then
    echo "[DAIC Error] Could not find .claude directory in current path or parent directories"
    exit 1
fi

# Use central hooks from CC_SESSIONS_PATH
if [[ -z "$CC_SESSIONS_PATH" ]]; then
    echo "[DAIC Error] CC_SESSIONS_PATH environment variable not set"
    exit 1
fi

HOOKS_DIR="$CC_SESSIONS_PATH/hooks"

# Run Python inline to toggle mode
python3 -c "
import sys
sys.path.insert(0, '$HOOKS_DIR')
from shared_state import toggle_daic_mode
mode = toggle_daic_mode()
print('[DAIC] ' + mode)
"